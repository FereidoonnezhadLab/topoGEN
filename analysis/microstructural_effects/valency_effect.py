"""
Author: Sara Cardona
Date: 10/10/2024

connectivity effect analysis in the differential modulus.
"""
import sys
import os
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), "../../..")))

import matplotlib.pyplot as plt
import numpy as np
import os
from matplotlib.cm import viridis
from scipy.interpolate import interp1d
from matplotlib import rcParams, font_manager
font_path_regular = 'D:/FONT/SourceSansPro-Regular.otf'
font_path_bold = 'D:/FONT/SourceSansPro-Bold.otf'
font_manager.fontManager.addfont(font_path_regular)
font_manager.fontManager.addfont(font_path_bold)
rcParams['font.sans-serif'] = ['Source Sans Pro']
rcParams['font.family'] = 'sans-serif'
rcParams['font.weight'] = 'regular'

from TopoGEN.utils.setup import setup_output_directory
job_description = "ResultsPlots"
output_directory = setup_output_directory(job_description)
"""
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
-------------------------------------------DATA THAT WE WANT TO REPLICATE-----------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
"""
data_12 = """0.010708957	106.7586118
0.030410306	111.4930513
0.082996472	142.1605118
0.183550012	362.933821
0.308694909	1715.823414
0.435985179	7700.233592"""
data_12 = np.genfromtxt(data_12.splitlines())
x_12, y_12 = data_12[:, 0], data_12[:, 1]


data_20 = """0.01052274	99.36956633
0.026665125	100.0591919
0.071528897	128.3480347
0.253448193	1338.548487
0.345536865	4490.31335
0.379926775	5799.792784"""
data_20 = np.genfromtxt(data_20.splitlines())
x_20, y_20 = data_20[:, 0], data_20[:, 1]

data_36 = """
0.015481517	73.8758246
0.041919901	88.3174867
0.095155577	175.3144878
0.160463166	594.5963032
0.220992235	1811.75716
0.237454983	2410.855464
0.353690911	9036.506208
"""
data_36 = np.genfromtxt(data_36.splitlines())
x_36, y_36 = data_36[:, 0], data_36[:, 1]

data_56 = """
0.01705085	365.5369209
0.039810717	660.3871446
0.045742243	800.0312364
0.082691395	1837.002392
0.111588399	2920.372123
0.195913107	5624.384463
"""
data_56 = np.genfromtxt(data_56.splitlines())
x_56, y_56 = data_56[:, 0], data_56[:, 1]

# Interpolation and creating 100 datapoints for each dataset
interp_12 = interp1d(x_12, y_12, kind='cubic')
interp_20 = interp1d(x_20, y_20, kind='cubic')
interp_36 = interp1d(x_36, y_36, kind='cubic')
interp_56 = interp1d(x_56, y_56, kind='cubic')

x_12_new = np.linspace(x_12.min(), x_12.max(), 100)
y_12_new = interp_12(x_12_new)

x_20_new = np.linspace(x_20.min(), x_20.max(), 100)
y_20_new = interp_20(x_20_new)

x_36_new = np.linspace(x_36.min(), x_36.max(), 100)
y_36_new = interp_36(x_36_new)

x_56_new = np.linspace(x_56.min(), x_56.max(), 100)
y_56_new = interp_56(x_56_new)

"""
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------OUR SIMULATION DATA----------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------
"""

# Define the smooth step function
def smooth_step(t):
    return t**3 * (10 - 15*t + 6*t**2)

t_new = np.linspace(0.0, 1, 101)
strain = np.array([smooth_step(time) for time in t_new])
strain_adjusted = strain * 0.5
DomainPhysicalDimension = 40

"""
Pure connectivity Effect
"""
# z = 3.12
RF312_1 = """5.30E-07
3.18E-06
1.26E-05
3.42E-05
7.37E-05
1.36E-04
2.27E-04
3.50E-04
5.10E-04
7.11E-04
9.56E-04
1.25E-03
1.59E-03
1.99E-03
2.45E-03
2.96E-03
3.54E-03
4.18E-03
4.90E-03
5.68E-03
6.53E-03
7.46E-03
8.46E-03
9.55E-03
1.07E-02
1.20E-02
1.33E-02
1.48E-02
1.63E-02
1.80E-02
1.97E-02
2.16E-02
2.36E-02
2.57E-02
2.79E-02
3.03E-02
3.29E-02
3.56E-02
3.85E-02
4.16E-02
4.49E-02
4.84E-02
5.21E-02
5.61E-02
6.04E-02
6.50E-02
6.99E-02
7.51E-02
8.07E-02
8.66E-02
9.30E-02
9.99E-02
1.07E-01
1.15E-01
1.24E-01
1.33E-01
1.43E-01
1.54E-01
1.65E-01
1.77E-01
1.91E-01
2.05E-01
2.21E-01
2.37E-01
2.55E-01
2.75E-01
2.96E-01
3.18E-01
3.42E-01
3.68E-01
3.95E-01
4.24E-01
4.55E-01
4.88E-01
5.22E-01
5.58E-01
5.95E-01
6.33E-01
6.72E-01
7.11E-01
7.51E-01
7.90E-01
8.29E-01
8.66E-01
9.02E-01
9.36E-01
9.68E-01
1.00E+00
1.04E+00
1.07E+00
1.10E+00
1.11E+00
1.12E+00
1.13E+00
1.14E+00
1.14E+00
1.14E+00
1.15E+00
1.15E+00
1.15E+00
1.15E+00
"""
RF312_2 = """4.40E-07
2.65E-06
1.04E-05
2.84E-05
6.12E-05
1.13E-04
1.88E-04
2.91E-04
4.24E-04
5.90E-04
7.94E-04
1.04E-03
1.32E-03
1.65E-03
2.03E-03
2.46E-03
2.93E-03
3.47E-03
4.05E-03
4.70E-03
5.40E-03
6.17E-03
7.00E-03
7.89E-03
8.85E-03
9.89E-03
1.10E-02
1.22E-02
1.35E-02
1.48E-02
1.63E-02
1.78E-02
1.95E-02
2.13E-02
2.32E-02
2.52E-02
2.73E-02
2.97E-02
3.22E-02
3.48E-02
3.77E-02
4.08E-02
4.41E-02
4.76E-02
5.15E-02
5.56E-02
6.01E-02
6.50E-02
7.03E-02
7.60E-02
8.23E-02
8.91E-02
9.65E-02
1.05E-01
1.13E-01
1.23E-01
1.33E-01
1.45E-01
1.57E-01
1.70E-01
1.85E-01
2.01E-01
2.18E-01
2.37E-01
2.57E-01
2.79E-01
3.03E-01
3.28E-01
3.56E-01
3.86E-01
4.17E-01
4.51E-01
4.87E-01
5.26E-01
5.66E-01
6.08E-01
6.51E-01
6.96E-01
7.42E-01
7.89E-01
8.35E-01
8.82E-01
9.28E-01
9.72E-01
1.02E+00
1.06E+00
1.09E+00
1.13E+00
1.16E+00
1.19E+00
1.22E+00
1.24E+00
1.26E+00
1.27E+00
1.28E+00
1.29E+00
1.30E+00
1.30E+00
1.30E+00
1.30E+00
1.30E+00
"""
RF312_3 = """4.65E-07
2.79E-06
1.10E-05
3.00E-05
6.46E-05
1.19E-04
1.99E-04
3.06E-04
4.46E-04
6.22E-04
8.36E-04
1.09E-03
1.39E-03
1.74E-03
2.13E-03
2.58E-03
3.08E-03
3.63E-03
4.24E-03
4.90E-03
5.63E-03
6.41E-03
7.25E-03
8.16E-03
9.13E-03
1.02E-02
1.13E-02
1.25E-02
1.37E-02
1.51E-02
1.65E-02
1.80E-02
1.96E-02
2.13E-02
2.31E-02
2.50E-02
2.70E-02
2.92E-02
3.14E-02
3.39E-02
3.65E-02
3.93E-02
4.23E-02
4.55E-02
4.89E-02
5.26E-02
5.65E-02
6.07E-02
6.52E-02
7.00E-02
7.51E-02
8.06E-02
8.65E-02
9.27E-02
9.94E-02
1.07E-01
1.14E-01
1.23E-01
1.31E-01
1.41E-01
1.51E-01
1.62E-01
1.73E-01
1.86E-01
1.99E-01
2.13E-01
2.29E-01
2.45E-01
2.62E-01
2.81E-01
3.00E-01
3.21E-01
3.43E-01
3.65E-01
3.89E-01
4.14E-01
4.40E-01
4.66E-01
4.93E-01
5.20E-01
5.47E-01
5.74E-01
6.01E-01
6.26E-01
6.51E-01
6.74E-01
6.96E-01
7.16E-01
7.34E-01
7.51E-01
7.65E-01
7.77E-01
7.87E-01
7.96E-01
8.02E-01
8.07E-01
8.10E-01
8.12E-01
8.13E-01
8.14E-01
8.14E-01
"""
RF312_4 = """3.72E-06
9.78E-06
2.02E-05
3.59E-05
6.93E-05
1.20E-04
1.93E-04
2.91E-04
4.17E-04
5.75E-04
7.66E-04
9.94E-04
1.26E-03
1.57E-03
1.92E-03
2.31E-03
2.75E-03
3.24E-03
3.78E-03
4.36E-03
5.00E-03
5.69E-03
6.43E-03
7.22E-03
8.07E-03
8.98E-03
9.94E-03
1.10E-02
1.21E-02
1.32E-02
1.44E-02
1.57E-02
1.71E-02
1.85E-02
2.01E-02
2.17E-02
2.34E-02
2.52E-02
2.71E-02
2.92E-02
3.13E-02
3.36E-02
3.59E-02
3.85E-02
4.11E-02
4.39E-02
4.69E-02
5.01E-02
5.34E-02
5.70E-02
6.08E-02
6.48E-02
6.91E-02
7.36E-02
7.84E-02
8.36E-02
8.91E-02
9.49E-02
1.01E-01
1.08E-01
1.15E-01
1.22E-01
1.30E-01
1.39E-01
1.48E-01
1.58E-01
1.68E-01
1.79E-01
1.90E-01
2.02E-01
2.14E-01
2.27E-01
2.41E-01
2.55E-01
2.70E-01
2.85E-01
3.00E-01
3.16E-01
3.32E-01
3.48E-01
3.64E-01
3.79E-01
3.94E-01
4.07E-01
4.21E-01
4.33E-01
4.44E-01
4.55E-01
4.65E-01
4.73E-01
4.81E-01
4.87E-01
4.93E-01
4.97E-01
5.00E-01
5.03E-01
5.05E-01
5.06E-01
5.07E-01
5.07E-01
5.07E-01
"""
RF312_5 = """3.92E-06
1.03E-05
2.13E-05
3.79E-05
7.32E-05
1.27E-04
2.04E-04
3.08E-04
4.41E-04
6.08E-04
8.12E-04
1.05E-03
1.34E-03
1.67E-03
2.04E-03
2.47E-03
2.94E-03
3.47E-03
4.05E-03
4.69E-03
5.39E-03
6.15E-03
6.97E-03
7.86E-03
8.81E-03
9.83E-03
1.09E-02
1.21E-02
1.33E-02
1.46E-02
1.60E-02
1.75E-02
1.91E-02
2.07E-02
2.25E-02
2.43E-02
2.63E-02
2.83E-02
3.05E-02
3.28E-02
3.52E-02
3.78E-02
4.05E-02
4.34E-02
4.64E-02
4.96E-02
5.30E-02
5.66E-02
6.04E-02
6.44E-02
6.86E-02
7.31E-02
7.79E-02
8.29E-02
8.83E-02
9.39E-02
9.99E-02
1.06E-01
1.13E-01
1.20E-01
1.28E-01
1.36E-01
1.45E-01
1.54E-01
1.64E-01
1.74E-01
1.85E-01
1.96E-01
2.08E-01
2.21E-01
2.34E-01
2.47E-01
2.61E-01
2.76E-01
2.91E-01
3.07E-01
3.22E-01
3.39E-01
3.55E-01
3.71E-01
3.88E-01
4.04E-01
4.19E-01
4.35E-01
4.49E-01
4.63E-01
4.76E-01
4.87E-01
4.98E-01
5.08E-01
5.16E-01
5.23E-01
5.29E-01
5.34E-01
5.38E-01
5.41E-01
5.43E-01
5.44E-01
5.44E-01
5.45E-01
5.45E-01
"""
RF312_6 = """0.00E+00
1.24E-06
7.09E-06
2.18E-05
4.98E-05
9.45E-05
1.60E-04
2.49E-04
3.64E-04
5.10E-04
6.87E-04
8.99E-04
1.15E-03
1.44E-03
1.76E-03
2.13E-03
2.55E-03
3.01E-03
3.51E-03
4.07E-03
4.68E-03
5.33E-03
6.04E-03
6.81E-03
7.62E-03
8.50E-03
9.44E-03
1.04E-02
1.15E-02
1.27E-02
1.39E-02
1.52E-02
1.66E-02
1.80E-02
1.96E-02
2.13E-02
2.30E-02
2.49E-02
2.69E-02
2.91E-02
3.14E-02
3.38E-02
3.64E-02
3.92E-02
4.22E-02
4.54E-02
4.88E-02
5.24E-02
5.63E-02
6.05E-02
6.49E-02
6.97E-02
7.47E-02
8.01E-02
8.59E-02
9.21E-02
9.87E-02
1.06E-01
1.13E-01
1.21E-01
1.30E-01
1.39E-01
1.49E-01
1.59E-01
1.70E-01
1.82E-01
1.94E-01
2.07E-01
2.21E-01
2.36E-01
2.51E-01
2.67E-01
2.84E-01
3.01E-01
3.19E-01
3.38E-01
3.57E-01
3.76E-01
3.96E-01
4.15E-01
4.35E-01
4.54E-01
4.73E-01
4.91E-01
5.08E-01
5.24E-01
5.39E-01
5.54E-01
5.66E-01
5.78E-01
5.88E-01
5.96E-01
6.03E-01
6.09E-01
6.13E-01
6.16E-01
6.19E-01
6.20E-01
6.21E-01
6.21E-01
6.21E-01
"""
RF312_7 = """0.00E+00
1.50E-06
1.04E-05
2.82E-05
6.22E-05
1.18E-04
1.99E-04
3.10E-04
4.54E-04
6.35E-04
8.57E-04
1.12E-03
1.43E-03
1.79E-03
2.21E-03
2.67E-03
3.19E-03
3.77E-03
4.41E-03
5.12E-03
5.88E-03
6.72E-03
7.62E-03
8.59E-03
9.64E-03
1.08E-02
1.20E-02
1.32E-02
1.46E-02
1.61E-02
1.76E-02
1.93E-02
2.10E-02
2.29E-02
2.48E-02
2.69E-02
2.91E-02
3.15E-02
3.40E-02
3.67E-02
3.95E-02
4.26E-02
4.58E-02
4.92E-02
5.29E-02
5.68E-02
6.10E-02
6.55E-02
7.03E-02
7.54E-02
8.09E-02
8.68E-02
9.32E-02
9.99E-02
1.07E-01
1.15E-01
1.24E-01
1.33E-01
1.42E-01
1.53E-01
1.64E-01
1.76E-01
1.89E-01
2.03E-01
2.18E-01
2.34E-01
2.51E-01
2.70E-01
2.89E-01
3.10E-01
3.33E-01
3.56E-01
3.81E-01
4.08E-01
4.35E-01
4.64E-01
4.94E-01
5.25E-01
5.57E-01
5.89E-01
6.22E-01
6.54E-01
6.86E-01
7.17E-01
7.48E-01
7.76E-01
8.04E-01
8.29E-01
8.52E-01
8.73E-01
8.91E-01
9.06E-01
9.19E-01
9.30E-01
9.38E-01
9.44E-01
9.49E-01
9.51E-01
9.53E-01
9.53E-01
9.53E-01
"""
RF312_8 = """3.63E-06
9.56E-06
1.97E-05
3.50E-05
6.77E-05
0.000117725
0.000188853
0.000284553
0.000408015
0.000562336
0.000750217
0.000974247
0.00123658
0.00153961
0.00188532
0.00227581
0.00271297
0.00319846
0.00373386
0.00432081
0.00496105
0.00565558
0.00640672
0.00721635
0.00808731
0.00902149
0.0100223
0.011094
0.0122379
0.0134569
0.0147555
0.0161397
0.0176103
0.019177
0.0208466
0.0226224
0.0245171
0.0265409
0.0286976
0.0309955
0.0334467
0.0360919
0.0389129
0.0419387
0.0451726
0.0486331
0.0523022
0.0562329
0.0604321
0.064932
0.0697612
0.0749484
0.0805202
0.086512
0.0929667
0.0999106
0.107386
0.115429
0.12409
0.133408
0.143448
0.154276
0.165944
0.178504
0.19202
0.206545
0.222126
0.238844
0.256721
0.275823
0.296167
0.317784
0.340748
0.365116
0.390853
0.417887
0.446073
0.475148
0.504889
0.535025
0.565278
0.593655
0.621413
0.648277
0.67394
0.698149
0.722344
0.744808
0.765288
0.783638
0.799767
0.813656
0.825294
0.834767
0.842221
0.847827
0.851795
0.854392
0.855915
0.856593
0.856952
"""
RF312_9 = """3.00E-06
7.89E-06
1.63E-05
2.89E-05
5.59E-05
9.72E-05
0.000155889
0.000234885
0.000336889
0.000464283
0.000619473
0.000804457
0.00102137
0.00127186
0.00155782
0.0018806
0.00224178
0.00264255
0.00308408
0.00356758
0.00409357
0.00466293
0.00527635
0.00593569
0.00664095
0.00739383
0.00819495
0.00904617
0.00994868
0.0109058
0.0119254
0.0130112
0.014166
0.0153938
0.0167053
0.0181493
0.0196752
0.0212732
0.0229389
0.024692
0.0264748
0.0283641
0.0303799
0.0325378
0.0348283
0.0372767
0.0398599
0.0426013
0.0455136
0.0486027
0.051872
0.0553495
0.0590367
0.062943
0.0670826
0.0714647
0.0761071
0.0810148
0.0862039
0.0916998
0.0975138
0.103656
0.110139
0.116982
0.124199
0.131798
0.139797
0.148197
0.156997
0.166176
0.175733
0.185647
0.195899
0.206452
0.217277
0.228333
0.23955
0.250889
0.262283
0.27365
0.284899
0.295956
0.306715
0.317071
0.326945
0.336257
0.344928
0.352894
0.360123
0.366589
0.372441
0.377632
0.38213
0.385926
0.38902
0.391282
0.392828
0.393774
0.394256
0.394462
0.394538
"""
RF312_10 = """4.30E-06
1.13E-05
2.33E-05
4.15E-05
8.01E-05
0.000139243
0.000223358
0.000336499
0.000482444
0.00066469
0.000886487
0.00115076
0.00146034
0.00181772
0.0022252
0.00268498
0.003199
0.00376926
0.00439809
0.00508739
0.00583976
0.00665738
0.0075431
0.00850028
0.00953308
0.0106446
0.0118385
0.0131196
0.0144907
0.015957
0.0175242
0.0192003
0.0209897
0.0229029
0.0249496
0.0271399
0.0294825
0.0319924
0.0346824
0.0375634
0.0406534
0.0439743
0.0475403
0.0513717
0.0554908
0.0599288
0.0647091
0.0698691
0.0754433
0.0814826
0.0880134
0.0950863
0.102753
0.111073
0.120102
0.129907
0.140572
0.152173
0.164795
0.178519
0.193442
0.209686
0.227335
0.246541
0.267495
0.290226
0.314861
0.341581
0.370438
0.401517
0.435043
0.471047
0.50954
0.550522
0.593859
0.639353
0.686762
0.735816
0.786084
0.837129
0.88845
0.939606
0.989911
1.03887
1.08593
1.1314
1.17666
1.21876
1.25707
1.29137
1.3205
1.34267
1.3606
1.37483
1.38556
1.39334
1.3985
1.40158
1.40301
1.40357
1.40375
"""
RF312 = [np.array([float(x) for x in rf.split()]) for rf in [RF312_1, RF312_2, RF312_3, RF312_4, RF312_5, RF312_6,
                                                             RF312_7, RF312_8, RF312_9, RF312_10]]

# z = 3.20
RF320_1 = """5.45E-07
3.27E-06
1.29E-05
3.51E-05
7.56E-05
1.40E-04
2.33E-04
3.59E-04
5.23E-04
7.29E-04
9.81E-04
1.28E-03
1.63E-03
2.04E-03
2.51E-03
3.03E-03
3.62E-03
4.27E-03
4.99E-03
5.78E-03
6.63E-03
7.56E-03
8.57E-03
9.66E-03
1.08E-02
1.21E-02
1.34E-02
1.48E-02
1.63E-02
1.79E-02
1.97E-02
2.15E-02
2.34E-02
2.55E-02
2.77E-02
3.01E-02
3.25E-02
3.52E-02
3.80E-02
4.11E-02
4.43E-02
4.77E-02
5.14E-02
5.53E-02
5.95E-02
6.39E-02
6.87E-02
7.39E-02
7.94E-02
8.53E-02
9.16E-02
9.85E-02
1.06E-01
1.14E-01
1.22E-01
1.31E-01
1.41E-01
1.52E-01
1.63E-01
1.76E-01
1.89E-01
2.03E-01
2.18E-01
2.35E-01
2.52E-01
2.71E-01
2.92E-01
3.14E-01
3.39E-01
3.65E-01
3.93E-01
4.22E-01
4.52E-01
4.84E-01
5.18E-01
5.54E-01
5.91E-01
6.30E-01
6.70E-01
7.11E-01
7.52E-01
7.94E-01
8.35E-01
8.75E-01
9.14E-01
9.51E-01
9.86E-01
1.02E+00
1.05E+00
1.07E+00
1.10E+00
1.12E+00
1.14E+00
1.16E+00
1.18E+00
1.18E+00
1.19E+00
1.19E+00
1.19E+00
1.19E+00
1.18E+00
"""
RF320_2 = """5.35E-07
3.23E-06
1.27E-05
3.46E-05
7.46E-05
1.38E-04
2.30E-04
3.54E-04
5.16E-04
7.19E-04
9.67E-04
1.26E-03
1.61E-03
2.01E-03
2.47E-03
2.99E-03
3.57E-03
4.22E-03
4.93E-03
5.70E-03
6.55E-03
7.47E-03
8.47E-03
9.54E-03
1.07E-02
1.19E-02
1.32E-02
1.47E-02
1.62E-02
1.78E-02
1.95E-02
2.13E-02
2.32E-02
2.52E-02
2.74E-02
2.97E-02
3.21E-02
3.47E-02
3.75E-02
4.04E-02
4.35E-02
4.69E-02
5.05E-02
5.43E-02
5.84E-02
6.28E-02
6.75E-02
7.26E-02
7.80E-02
8.39E-02
9.03E-02
9.72E-02
1.05E-01
1.13E-01
1.21E-01
1.31E-01
1.41E-01
1.52E-01
1.64E-01
1.78E-01
1.92E-01
2.09E-01
2.26E-01
2.45E-01
2.65E-01
2.86E-01
3.10E-01
3.35E-01
3.63E-01
3.93E-01
4.25E-01
4.60E-01
4.97E-01
5.36E-01
5.78E-01
6.22E-01
6.67E-01
7.15E-01
7.64E-01
8.13E-01
8.63E-01
9.13E-01
9.62E-01
1.01E+00
1.06E+00
1.10E+00
1.14E+00
1.18E+00
1.21E+00
1.24E+00
1.27E+00
1.29E+00
1.31E+00
1.33E+00
1.34E+00
1.35E+00
1.36E+00
1.36E+00
1.36E+00
1.36E+00
1.36E+00
"""
RF320_3 = """2.29E-07
3.62E-06
1.39E-05
3.75E-05
7.98E-05
1.47E-04
2.45E-04
3.78E-04
5.50E-04
7.67E-04
1.03E-03
1.35E-03
1.72E-03
2.15E-03
2.63E-03
3.19E-03
3.80E-03
4.49E-03
5.24E-03
6.07E-03
6.97E-03
7.94E-03
9.00E-03
1.01E-02
1.14E-02
1.27E-02
1.41E-02
1.55E-02
1.71E-02
1.88E-02
2.06E-02
2.25E-02
2.45E-02
2.67E-02
2.90E-02
3.14E-02
3.40E-02
3.67E-02
3.97E-02
4.28E-02
4.62E-02
4.98E-02
5.36E-02
5.77E-02
6.21E-02
6.68E-02
7.19E-02
7.74E-02
8.34E-02
8.98E-02
9.66E-02
1.04E-01
1.12E-01
1.21E-01
1.30E-01
1.40E-01
1.51E-01
1.63E-01
1.76E-01
1.91E-01
2.06E-01
2.23E-01
2.41E-01
2.62E-01
2.84E-01
3.07E-01
3.33E-01
3.62E-01
3.92E-01
4.26E-01
4.63E-01
5.03E-01
5.45E-01
5.90E-01
6.38E-01
6.86E-01
7.36E-01
7.88E-01
8.42E-01
8.96E-01
9.52E-01
1.01E+00
1.06E+00
1.11E+00
1.17E+00
1.21E+00
1.26E+00
1.30E+00
1.34E+00
1.37E+00
1.40E+00
1.43E+00
1.45E+00
1.47E+00
1.48E+00
1.49E+00
1.50E+00
1.50E+00
1.50E+00
1.50E+00
1.50E+00
"""
RF320_4 = """5.08E-06
1.34E-05
2.75E-05
4.89E-05
9.45E-05
0.000164297
0.000263573
0.000397139
0.00056954
0.00078488
0.00104708
0.00135978
0.00172605
0.0021488
0.00263112
0.00317534
0.00378365
0.00445901
0.00520339
0.00601907
0.00690926
0.00787618
0.00892163
0.0100497
0.011263
0.012564
0.0139582
0.0154514
0.0170482
0.0187505
0.0205651
0.0224993
0.0245597
0.0267573
0.0291031
0.0316052
0.0342779
0.0371342
0.0401831
0.043451
0.046964
0.0507467
0.054823
0.0592203
0.0639661
0.0690958
0.0746349
0.0806591
0.0872044
0.0943275
0.102088
0.110544
0.119753
0.129805
0.140792
0.152817
0.166405
0.181252
0.197465
0.215158
0.23448
0.255321
0.278277
0.303678
0.33181
0.362999
0.397503
0.435585
0.477567
0.523736
0.574344
0.629532
0.689533
0.754338
0.823817
0.897742
0.975822
1.05758
1.14234
1.22936
1.31782
1.4067
1.49489
1.5814
1.66507
1.74485
1.8223
1.9013
1.97282
2.03653
2.09166
2.13676
2.16699
2.19061
2.20862
2.22206
2.23047
2.23509
2.23728
2.23807
2.23797
"""
RF320_5 = """5.30E-07
3.19E-06
1.26E-05
3.42E-05
7.37E-05
1.36E-04
2.27E-04
3.51E-04
5.11E-04
7.13E-04
9.60E-04
1.26E-03
1.60E-03
2.01E-03
2.47E-03
2.99E-03
3.58E-03
4.23E-03
4.95E-03
5.75E-03
6.61E-03
7.55E-03
8.57E-03
9.67E-03
1.08E-02
1.21E-02
1.35E-02
1.49E-02
1.64E-02
1.81E-02
1.99E-02
2.17E-02
2.37E-02
2.60E-02
2.83E-02
3.08E-02
3.33E-02
3.61E-02
3.90E-02
4.21E-02
4.55E-02
4.92E-02
5.32E-02
5.74E-02
6.20E-02
6.70E-02
7.24E-02
7.82E-02
8.46E-02
9.15E-02
9.90E-02
1.07E-01
1.16E-01
1.26E-01
1.36E-01
1.48E-01
1.61E-01
1.75E-01
1.90E-01
2.08E-01
2.28E-01
2.49E-01
2.71E-01
2.95E-01
3.21E-01
3.51E-01
3.85E-01
4.21E-01
4.61E-01
5.04E-01
5.50E-01
6.01E-01
6.57E-01
7.16E-01
7.77E-01
8.40E-01
9.07E-01
9.79E-01
1.05E+00
1.12E+00
1.20E+00
1.27E+00
1.34E+00
1.41E+00
1.47E+00
1.54E+00
1.60E+00
1.65E+00
1.70E+00
1.74E+00
1.78E+00
1.81E+00
1.83E+00
1.86E+00
1.87E+00
1.88E+00
1.89E+00
1.89E+00
1.90E+00
1.90E+00
1.90E+00
"""
RF320_6 = """4.32E-06
1.14E-05
2.34E-05
4.16E-05
8.04E-05
0.000139813
0.0002243
0.000337968
0.000484649
0.000667896
0.00089104
0.00115713
0.00146891
0.00182908
0.0022399
0.00270377
0.00322311
0.00379982
0.00443585
0.00513347
0.00589437
0.00672034
0.00761329
0.00857481
0.00960761
0.010714
0.0118975
0.0131605
0.0145058
0.0159379
0.0174627
0.0190829
0.0208076
0.0226415
0.0245932
0.0266701
0.028885
0.0312421
0.0337603
0.0364483
0.0393163
0.0423799
0.0456599
0.04917
0.0529337
0.0569661
0.0612908
0.0659255
0.0708958
0.0762269
0.0819518
0.0881074
0.0947413
0.101902
0.109635
0.118013
0.127074
0.136885
0.147503
0.159
0.17145
0.184942
0.199527
0.215339
0.232447
0.250945
0.270904
0.292459
0.315623
0.340471
0.367036
0.395358
0.425414
0.45717
0.490586
0.525542
0.561852
0.599298
0.637613
0.676443
0.715436
0.754278
0.792517
0.829789
0.865668
0.899776
0.93175
0.961332
0.988313
1.01247
1.03367
1.05227
1.06788
1.08046
1.09032
1.09769
1.10248
1.10547
1.10717
1.10789
1.10824
"""
RF320_7 = """5.67E-06
1.49E-05
3.08E-05
5.47E-05
0.000105707
0.000183814
0.000294909
0.000444379
0.000637365
0.000878463
0.00117213
0.00152234
0.00193296
0.00240722
0.0029483
0.00355938
0.00424334
0.00500272
0.00584043
0.00675931
0.00776137
0.00884922
0.0100254
0.0112933
0.012656
0.014117
0.015681
0.0173524
0.0191346
0.0210343
0.023059
0.0252133
0.0275054
0.0299445
0.0325399
0.0353078
0.0382542
0.0413934
0.0447406
0.0483132
0.0521209
0.0561969
0.060562
0.0652456
0.0702737
0.075697
0.0815458
0.0878706
0.0947183
0.102143
0.110197
0.11897
0.128502
0.138887
0.150232
0.163055
0.177068
0.192404
0.209216
0.227633
0.247413
0.269128
0.293005
0.319211
0.347677
0.37894
0.413222
0.450745
0.49183
0.53697
0.585971
0.638687
0.695033
0.754837
0.81781
0.883638
0.952063
1.02264
1.09469
1.16748
1.24036
1.31252
1.38317
1.45158
1.51702
1.57887
1.63654
1.68967
1.73771
1.78149
1.82081
1.85489
1.88357
1.90703
1.92456
1.93654
1.94431
1.94876
1.9508
1.95159
1.95172
"""
RF320_8 = """4.71E-06
1.24E-05
2.56E-05
4.55E-05
8.79E-05
0.000152775
0.000245114
0.000369379
0.000529806
0.00073037
0.000974632
0.00126611
0.00160793
0.00200317
0.00245452
0.00296493
0.00353668
0.00417238
0.00487432
0.00564543
0.00648752
0.00740415
0.00839771
0.00947224
0.0106302
0.0118763
0.0132147
0.0146503
0.0161875
0.0178346
0.0195974
0.021482
0.0234976
0.0256536
0.0279606
0.03043
0.0330776
0.0359152
0.038959
0.0422256
0.0457327
0.0494988
0.0535452
0.0578884
0.0625479
0.0675596
0.0729527
0.0787419
0.0849863
0.091721
0.0989907
0.106852
0.115394
0.12468
0.134798
0.145832
0.157888
0.17106
0.185478
0.201286
0.218647
0.23772
0.258668
0.281648
0.306882
0.334576
0.364863
0.39789
0.434045
0.473225
0.515556
0.561056
0.609559
0.660798
0.714868
0.771499
0.830511
0.891104
0.953132
1.01593
1.07884
1.14107
1.20255
1.2623
1.31962
1.37394
1.42486
1.47184
1.5144
1.5524
1.58565
1.61405
1.63774
1.65694
1.67194
1.68336
1.69163
1.69725
1.70075
1.70246
1.70351
"""
RF320_9 = """5.39E-06
1.42E-05
2.92E-05
5.19E-05
0.000100336
0.00017444
0.000279806
0.000421514
0.000604364
0.000832642
0.00111051
0.00144163
0.00182941
0.00227687
0.00278694
0.00336195
0.00400451
0.00471666
0.00550041
0.00635777
0.00729066
0.00830069
0.00939031
0.0105612
0.011816
0.0131562
0.0145862
0.0161074
0.0177255
0.0194432
0.021265
0.0231921
0.0252351
0.0273949
0.0296799
0.0320934
0.0346498
0.0373586
0.0402284
0.043277
0.0465227
0.0499729
0.05364
0.0575517
0.0617202
0.0661683
0.0709273
0.0760266
0.0814893
0.0873622
0.0936702
0.100459
0.107784
0.115689
0.124206
0.133421
0.143399
0.154184
0.165907
0.178653
0.192497
0.20755
0.223948
0.24179
0.261219
0.282411
0.305496
0.330614
0.357875
0.387431
0.419348
0.453702
0.490531
0.529802
0.571444
0.615236
0.66115
0.70876
0.758886
0.810183
0.861872
0.916325
0.975589
1.03193
1.08491
1.13687
1.18339
1.2171
1.24847
1.27803
1.29871
1.31546
1.33272
1.34583
1.355
1.36498
1.37199
1.37658
1.37927
1.38048
1.38114
"""
RF320_10 = """5.06E-06
1.33E-05
2.74E-05
4.88E-05
9.42E-05
0.000163806
0.000262763
0.000395894
0.000567643
0.000782188
0.0010434
0.00135462
0.00171929
0.00214016
0.00262012
0.0031616
0.00376711
0.00443836
0.00517763
0.0059878
0.00687021
0.00782651
0.0088599
0.0099727
0.0111664
0.0124442
0.0138092
0.0152635
0.016812
0.0184565
0.0202036
0.0220583
0.0240271
0.0261157
0.0283327
0.0306848
0.0331759
0.0358209
0.0386245
0.0416026
0.0447613
0.0481225
0.0516938
0.0555073
0.0595697
0.0639106
0.0685544
0.073528
0.0788564
0.0845812
0.0907374
0.0973649
0.104508
0.112215
0.120544
0.129565
0.139365
0.150014
0.161601
0.174215
0.187971
0.202971
0.219363
0.237288
0.256913
0.278375
0.301794
0.327348
0.355155
0.385371
0.418072
0.453373
0.491204
0.531577
0.574363
0.619408
0.666412
0.715075
0.764955
0.815545
0.866303
0.916695
0.966154
1.01411
1.06007
1.10358
1.14421
1.18165
1.21562
1.24592
1.27243
1.29515
1.31415
1.32957
1.34169
1.35077
1.35723
1.36144
1.36396
1.36507
1.36571
"""
RF320 = [np.array([float(x) for x in rf.split()]) for rf in [RF320_1, RF320_2, RF320_3, RF320_4, RF320_5,
                                                             RF320_6, RF320_7, RF320_8, RF320_9, RF320_10]]

# z = 3.36
RF336_1 = """4.76E-06
1.25E-05
2.58E-05
4.59E-05
8.86E-05
0.000154081
0.000247128
0.000372391
0.000534025
0.000735939
0.000981672
0.00127491
0.00161847
0.00201544
0.00246826
0.00297953
0.00355121
0.00418581
0.00488533
0.00565218
0.00648782
0.00739492
0.00837625
0.0094339
0.0105708
0.0117894
0.0130932
0.0144842
0.0159668
0.0175476
0.0192289
0.0210176
0.0229202
0.024944
0.027096
0.0293914
0.0318372
0.0344503
0.0372469
0.0402452
0.0434607
0.0469212
0.0506535
0.0546856
0.0590482
0.0637941
0.068957
0.0745988
0.0807692
0.0875371
0.0949644
0.103146
0.112178
0.12214
0.133196
0.145525
0.159303
0.174774
0.192219
0.211874
0.234048
0.259208
0.287548
0.319512
0.356763
0.398027
0.444154
0.495681
0.55293
0.614941
0.683581
0.758306
0.839005
0.925391
1.01701
1.11336
1.21214
1.31372
1.41713
1.52122
1.62471
1.72807
1.8289
1.9261
2.01869
2.10584
2.18672
2.26074
2.32749
2.38673
2.43836
2.48243
2.51917
2.54891
2.57261
2.59222
2.60709
2.61743
2.62385
2.62771
2.62883
"""
RF336_2 = """5.73E-06
1.51E-05
3.11E-05
5.52E-05
0.000106704
0.000185536
0.000297672
0.00044855
0.000643327
0.000886722
0.00118319
0.00153675
0.0019514
0.00243051
0.00297755
0.00359579
0.00428838
0.00505801
0.00590787
0.00684053
0.00785945
0.00896733
0.0101683
0.0114651
0.0128619
0.0143633
0.0159739
0.017699
0.0195453
0.0215188
0.0236261
0.0258762
0.0282781
0.0308417
0.0335796
0.0365069
0.0396373
0.0429853
0.04657
0.0504103
0.0545249
0.0589432
0.0636958
0.0688119
0.074327
0.0802833
0.0867196
0.0936844
0.101226
0.109412
0.118313
0.128009
0.13859
0.150182
0.162885
0.176823
0.192155
0.209064
0.227731
0.248425
0.271413
0.296986
0.325466
0.357231
0.392711
0.432291
0.47649
0.52576
0.580561
0.645708
0.716039
0.791272
0.872312
0.959638
1.04859
1.14441
1.24691
1.35445
1.46538
1.57845
1.69221
1.8052
1.91606
2.02348
2.1263
2.22341
2.31388
2.39698
2.47215
2.53897
2.59727
2.64712
2.68867
2.72232
2.74862
2.76829
2.78216
2.79124
2.7966
2.79899
2.8003
"""
RF336_3 = """5.46E-06
1.44E-05
2.96E-05
5.26E-05
0.00010171
0.000176866
0.000283769
0.000427626
0.000613314
0.000845375
0.00112799
0.00146515
0.00186049
0.00231746
0.00283929
0.00342945
0.00409018
0.0048245
0.00563541
0.00652558
0.00749744
0.00855452
0.00970051
0.0109385
0.0122711
0.0137046
0.0152405
0.0168867
0.0186475
0.02053
0.0225414
0.0246911
0.026986
0.0294386
0.032061
0.0348664
0.0378724
0.0410962
0.0445591
0.0482813
0.0522913
0.0566161
0.0612911
0.0663579
0.0718605
0.0778452
0.0843647
0.0914859
0.099281
0.107838
0.117244
0.127617
0.139082
0.151857
0.166041
0.18186
0.195172
0.210082
0.226741
0.245481
0.266632
0.295954
0.329098
0.365858
0.407371
0.454491
0.506917
0.566404
0.634479
0.711407
0.797626
0.893709
0.999746
1.11616
1.2428
1.39273
1.54348
1.69257
1.84647
2.00312
2.14695
2.29727
2.45349
2.60545
2.75154
2.8902
3.02034
3.14088
3.25092
3.34987
3.43743
3.51346
3.57813
3.63185
3.67523
3.70907
3.73434
3.75217
3.76378
3.77061
3.77363
"""
RF336_4 = """6.41E-06
1.69E-05
3.48E-05
6.18E-05
0.000119401
0.000207623
0.000333081
0.000501912
0.000719825
0.000992105
0.00132366
0.00171899
0.00218243
0.00271798
0.00332908
0.0040197
0.00479285
0.0056519
0.00659945
0.00763909
0.00877319
0.0100056
0.0113397
0.01278
0.0143311
0.0159978
0.0177871
0.0197048
0.0217596
0.0239585
0.0263124
0.0288301
0.031528
0.0344167
0.0375121
0.0408354
0.0444054
0.0482376
0.0523626
0.0568072
0.0615989
0.066778
0.0723886
0.0784766
0.0850983
0.0923134
0.100201
0.108836
0.118312
0.128745
0.140256
0.15302
0.167212
0.183048
0.200733
0.220607
0.243
0.268325
0.297779
0.333457
0.371322
0.414103
0.462886
0.517691
0.577902
0.648946
0.729598
0.820385
0.922709
1.03624
1.17522
1.32297
1.47702
1.63769
1.80528
1.96512
2.13227
2.30681
2.485
2.66403
2.84165
3.01558
3.18454
3.34589
3.49832
3.64042
3.7711
3.88935
3.99571
4.0894
4.17015
4.23872
4.2952
4.34006
4.37453
4.39968
4.41646
4.42651
4.43162
4.4337
4.43441
"""
RF336_5 = """6.64E-06
1.75E-05
3.60E-05
6.41E-05
0.000123776
0.000215239
0.000345309
0.000520351
0.000746296
0.00102864
0.00137254
0.00178269
0.00226345
0.00281893
0.00345307
0.00416941
0.00497122
0.00586193
0.00684484
0.00792303
0.00909963
0.0103782
0.0117625
0.0132567
0.0148617
0.0165824
0.0184235
0.0203902
0.0224876
0.0247259
0.0271122
0.0296571
0.0323698
0.0352614
0.0383462
0.0416385
0.0451567
0.0489181
0.0529954
0.0573777
0.0620739
0.067111
0.0725946
0.0784448
0.0847329
0.0915271
0.0988839
0.10681
0.115442
0.124878
0.135227
0.146605
0.15915
0.173022
0.188394
0.205468
0.224494
0.245745
0.269555
0.296326
0.326501
0.360577
0.399228
0.443168
0.492798
0.548801
0.611847
0.682354
0.760677
0.847688
0.943478
1.04812
1.16097
1.28904
1.41878
1.55187
1.6893
1.83017
1.96534
2.10586
2.24748
2.38638
2.52103
2.65033
2.77284
2.88831
2.99516
3.09284
3.18078
3.25867
3.32558
3.38238
3.4293
3.46685
3.49591
3.51749
3.53253
3.5422
3.5478
3.55027
3.55155
"""
RF336_6 = """6.25E-06
1.65E-05
3.39E-05
6.03E-05
0.000116448
0.000202499
0.000324887
0.000489582
0.000702274
0.00096823
0.00129225
0.00167882
0.00213233
0.00265671
0.00325549
0.00393246
0.00469068
0.00553324
0.00646259
0.00748276
0.00859585
0.00980446
0.0111124
0.0125226
0.014038
0.0156618
0.0173988
0.0192521
0.0212292
0.0233369
0.025579
0.0279675
0.0305115
0.0332203
0.0361016
0.0391709
0.0424415
0.0459301
0.0496567
0.0536487
0.0579296
0.062529
0.0674886
0.0728549
0.0786592
0.0849588
0.0918094
0.09928
0.107446
0.116422
0.12633
0.137314
0.149551
0.163244
0.178632
0.196009
0.215709
0.238162
0.263868
0.293446
0.330495
0.370543
0.416914
0.470779
0.533373
0.603153
0.686613
0.782525
0.891826
1.01529
1.15332
1.30562
1.47161
1.64987
1.83852
2.03561
2.23889
2.44604
2.65479
2.86273
3.06729
3.26651
3.45834
3.64096
3.81305
3.97323
4.12083
4.25483
4.37497
4.48106
4.5731
4.65114
4.71595
4.76804
4.80848
4.83854
4.85955
4.87305
4.88088
4.88431
4.88607
"""
RF336_7 = """5.79E-06
1.53E-05
3.14E-05
5.59E-05
0.000107935
0.000187713
0.000301229
0.00045406
0.000651479
0.000898387
0.00119937
0.0015588
0.00198071
0.00246883
0.00302695
0.00365869
0.00436725
0.00515594
0.00602827
0.00698757
0.00803713
0.00918116
0.0104233
0.0117685
0.0132202
0.0147849
0.0164672
0.018274
0.0202129
0.0222934
0.02452
0.0269076
0.0294671
0.03221
0.0351501
0.0383107
0.0417116
0.0453807
0.0493399
0.0536192
0.0582604
0.063297
0.0687723
0.0747499
0.0812811
0.0884589
0.0963695
0.105109
0.114803
0.125606
0.137656
0.151159
0.166351
0.183485
0.202879
0.224955
0.250154
0.279018
0.312213
0.350497
0.398938
0.454364
0.513516
0.581617
0.659611
0.74426
0.841105
0.954053
1.07975
1.21829
1.36941
1.53198
1.70619
1.89053
2.08365
2.28395
2.48945
2.6981
2.90767
3.11594
3.32073
3.5202
3.71232
3.89545
4.06812
4.22904
4.37716
4.51182
4.63249
4.73897
4.83133
4.90981
4.97497
5.02758
5.06858
5.09916
5.12072
5.13478
5.14307
5.14675
5.14879
"""
RF336_8 = """6.27E-06
1.65E-05
3.40E-05
6.04E-05
0.000116765
0.000203056
0.000325811
0.000491028
0.000704368
0.000971039
0.00129597
0.00168368
0.00213855
0.00266442
0.0032649
0.00394378
0.00470424
0.00554969
0.0064834
0.00750892
0.00862871
0.00984664
0.0111663
0.0125922
0.0141268
0.0157778
0.0175477
0.019441
0.0214638
0.023624
0.0259255
0.0283768
0.030988
0.0337661
0.0367216
0.0398667
0.043216
0.0467845
0.0505894
0.0546486
0.0589818
0.0636176
0.0685767
0.0738867
0.0795886
0.0857114
0.0922943
0.0993832
0.107024
0.115267
0.124192
0.13386
0.144363
0.155804
0.168284
0.181923
0.196938
0.213428
0.231571
0.251866
0.274303
0.299075
0.326542
0.357138
0.390916
0.428545
0.470454
0.517087
0.568871
0.626238
0.68948
0.758822
0.834414
0.916064
1.00358
1.09652
1.19431
1.29601
1.40067
1.50709
1.61405
1.72026
1.82447
1.92544
2.02203
2.11321
2.19811
2.27603
2.34648
2.40911
2.46384
2.51086
2.55045
2.58309
2.60909
2.62894
2.64313
2.65248
2.65782
2.66018
2.66141
"""
RF336_9 = """6.24E-06
1.64E-05
3.38E-05
6.01E-05
0.000116122
0.00020192
0.000323905
0.000488028
0.000699835
0.000964429
0.00128657
0.00167063
0.00212071
0.00264058
0.00323344
0.00390343
0.00465294
0.00548509
0.00640282
0.00740915
0.0085058
0.00969679
0.010985
0.0123732
0.0138662
0.0154681
0.0171836
0.0190184
0.0209784
0.0230699
0.0253002
0.0276802
0.030219
0.0329294
0.035823
0.0389212
0.0422363
0.0457866
0.0495921
0.0536768
0.0580596
0.0627729
0.0678447
0.0733172
0.0796157
0.0868362
0.0946636
0.103121
0.112286
0.12185
0.130691
0.140338
0.150941
0.162606
0.175467
0.190836
0.207819
0.226632
0.247515
0.270624
0.296398
0.325219
0.357521
0.393771
0.434638
0.480541
0.532118
0.589937
0.65464
0.726709
0.806647
0.894673
0.990964
1.09537
1.20751
1.32673
1.45225
1.58279
1.71702
1.85348
1.99053
2.12638
2.26319
2.40621
2.55453
2.70661
2.86118
3.01296
3.15364
3.29326
3.42355
3.54616
3.65249
3.73509
3.7923
3.83186
3.85241
3.86401
3.87639
3.88176
3.88446
"""
RF336_10 = """5.98E-06
1.57E-05
3.24E-05
5.76E-05
0.000111309
0.000193524
0.000310408
0.000467629
0.000670479
0.0009238
0.00123213
0.00159949
0.00202968
0.00252602
0.00309162
0.0037292
0.00444144
0.005231
0.00610022
0.00705095
0.00808494
0.00920467
0.010413
0.0117123
0.0131068
0.0145989
0.0161928
0.0178944
0.0197086
0.0216433
0.0237076
0.0259109
0.0282597
0.0307618
0.0334309
0.0362811
0.0393287
0.042595
0.0460984
0.0498622
0.0539146
0.0582829
0.0629984
0.0681084
0.0736601
0.0797042
0.0863038
0.0935236
0.101423
0.110049
0.119462
0.129713
0.140898
0.153151
0.166869
0.181995
0.198736
0.217327
0.238029
0.260936
0.286651
0.315615
0.348319
0.385292
0.427039
0.474244
0.527484
0.587355
0.654524
0.729315
0.812081
0.905292
1.00729
1.11437
1.22733
1.34867
1.4707
1.59535
1.72436
1.85493
1.98209
2.10864
2.23155
2.34955
2.46157
2.56666
2.66404
2.7534
2.83403
2.90553
2.96779
3.02084
3.06463
3.09984
3.12714
3.14731
3.16128
3.17011
3.17508
3.17723
3.1783
"""
RF336 = [np.array([float(x) for x in rf.split()]) for rf in [RF336_1, RF336_2, RF336_3, RF336_4, RF336_5, RF336_6,
                                                             RF336_7, RF336_8, RF336_9, RF336_10]]

# z = 3.56
RF356_1 = """7.70E-06
2.03E-05
4.17E-05
7.42E-05
0.000143286
0.000249142
0.000399742
0.000602386
0.000864082
0.00119113
0.00158971
0.00206519
0.002623
0.00326783
0.00400459
0.00483755
0.00577133
0.00680964
0.00795783
0.00921934
0.0105992
0.0121026
0.0137347
0.0154997
0.017406
0.0194604
0.0216701
0.0240475
0.0266041
0.0293508
0.0323014
0.0354733
0.0388806
0.0425445
0.0464919
0.0507503
0.0553497
0.060328
0.0657251
0.0715861
0.0779707
0.0849334
0.0925425
0.100882
0.110051
0.120154
0.132238
0.145
0.158944
0.17445
0.191839
0.210537
0.232387
0.257532
0.286386
0.3196
0.358427
0.403115
0.455056
0.516959
0.588698
0.680298
0.785148
0.901685
1.03286
1.18295
1.34777
1.53915
1.75403
1.99026
2.24703
2.51916
2.80299
3.10221
3.4135
3.73237
4.05447
4.37589
4.69397
5.0046
5.30554
5.59584
5.87215
6.13183
6.3738
6.59641
6.79844
6.98051
7.14265
7.28493
7.40745
7.5108
7.59592
7.66399
7.7165
7.75519
7.78196
7.79898
7.80861
7.81281
7.8149
"""
RF356_2 = """7.61E-06
2.00E-05
4.12E-05
7.33E-05
0.000141524
0.000246022
0.000394572
0.000594352
0.000852017
0.00117368
0.00156495
0.00203097
0.00257639
0.00320532
0.00392165
0.00472888
0.00563017
0.00662871
0.00772741
0.00892891
0.0102357
0.0116504
0.0131763
0.0148171
0.0165772
0.0184616
0.0204777
0.022632
0.0249309
0.0273813
0.0300023
0.0327988
0.0357901
0.0389956
0.0424393
0.0461385
0.0501335
0.0544544
0.0591398
0.064235
0.069791
0.0758636
0.0825172
0.0898302
0.0978863
0.106792
0.11667
0.12766
0.139944
0.153746
0.169308
0.186925
0.206986
0.229949
0.256352
0.28688
0.322359
0.363829
0.412383
0.469392
0.53646
0.615371
0.708024
0.816442
0.942525
1.0879
1.25369
1.44051
1.6794
1.90895
2.15579
2.41943
2.69732
2.95554
3.25158
3.55417
3.85847
4.16149
4.46043
4.75276
5.04144
5.32167
5.58835
5.83941
6.07402
6.28798
6.48168
6.66003
6.81988
6.96046
7.07906
7.17722
7.25322
7.31138
7.3539
7.38323
7.40187
7.4121
7.41643
7.41799
7.41763
"""
RF356_3 = """7.93E-06
2.09E-05
4.30E-05
7.64E-05
0.000147521
0.0002565
0.000411462
0.000620001
0.000889158
0.00122545
0.00163505
0.00212354
0.00269626
0.0033581
0.00411385
0.00496754
0.00592383
0.00698672
0.00816016
0.0094491
0.0108584
0.0123927
0.0140568
0.0158581
0.0178013
0.019895
0.0221477
0.0245698
0.0271718
0.0299687
0.0329757
0.0362086
0.0396874
0.0434367
0.0474838
0.0518564
0.0565908
0.0617291
0.0673172
0.073408
0.080062
0.087361
0.0953892
0.104242
0.114039
0.124909
0.137021
0.15055
0.165728
0.182829
0.202189
0.22419
0.249368
0.27829
0.311661
0.350409
0.395591
0.448411
0.510544
0.58366
0.669493
0.771634
0.891025
1.03712
1.19708
1.38039
1.58666
1.81721
2.06423
2.3413
2.6387
2.95351
3.28308
3.62379
3.97217
4.32458
4.67761
5.0274
5.37105
5.70796
6.03508
6.34767
6.64422
6.92287
7.17985
7.41447
7.62858
7.82155
7.99323
8.14384
8.27375
8.38366
8.47451
8.54753
8.60417
8.64628
8.67579
8.69493
8.70612
8.71108
8.71375
"""
RF356_4 = """7.08E-06
1.87E-05
3.84E-05
6.83E-05
0.000131883
0.000229295
0.000367783
0.000554082
0.000794428
0.00109466
0.00146007
0.00189562
0.00240589
0.00299505
0.00366712
0.00442555
0.00527391
0.00621566
0.00725436
0.00839269
0.00963486
0.0109839
0.0124436
0.0140175
0.0157115
0.0175304
0.019481
0.0215693
0.0238049
0.0261975
0.0287578
0.0315021
0.0344471
0.0376042
0.0410037
0.0446599
0.0485971
0.052848
0.0574497
0.062441
0.0678668
0.073781
0.0802329
0.0872968
0.095049
0.103588
0.113021
0.123481
0.135122
0.148117
0.16268
0.179067
0.197581
0.218579
0.242534
0.269932
0.301401
0.337777
0.381664
0.431702
0.489377
0.556398
0.634346
0.72332
0.828031
0.950348
1.08949
1.24752
1.42495
1.62114
1.83489
2.06699
2.31424
2.57406
2.84367
3.12026
3.40063
3.68202
3.96295
4.23977
4.50896
4.76855
5.01594
5.248
5.46457
5.66559
5.85056
6.01837
6.16838
6.29975
6.41269
6.5067
6.58387
6.64546
6.693
6.7278
6.75175
6.76648
6.7744
6.77774
6.7791
"""
RF356_5 = """6.48E-06
1.71E-05
3.51E-05
6.24E-05
0.000120588
0.000209656
0.000336295
0.000506672
0.000726523
0.00100121
0.00133557
0.00173421
0.00220134
0.00274088
0.00335649
0.00405186
0.00483027
0.00569538
0.00664975
0.00769803
0.00884326
0.0100897
0.0114407
0.0129028
0.01448
0.01618
0.0180101
0.01998
0.0221007
0.024385
0.0268483
0.0295076
0.0323872
0.0355089
0.0389017
0.0425979
0.0466374
0.051065
0.0559337
0.0613093
0.0672693
0.0738939
0.0813062
0.0896252
0.0990132
0.109642
0.121754
0.135604
0.151552
0.17008
0.191639
0.216853
0.246534
0.281629
0.323317
0.372987
0.43229
0.502928
0.587112
0.687157
0.804749
0.942248
1.10154
1.28387
1.48984
1.72084
1.97543
2.25291
2.59157
2.91601
3.25306
3.60562
3.95926
4.27944
4.64119
5.00764
5.36829
5.73345
6.08723
6.42249
6.74724
7.05626
7.34426
7.61454
7.86621
8.09085
8.2933
8.47649
8.63894
8.78105
8.90407
9.00802
9.09299
9.16151
9.21344
9.25024
9.27453
9.28751
9.29204
9.2933
9.2923
"""
RF356_6 = """8.08E-06
2.13E-05
4.38E-05
7.79E-05
0.000150529
0.000261789
0.000420063
0.000633121
0.000908281
0.00125234
0.00167181
0.00217262
0.00276053
0.00344087
0.00421864
0.00509918
0.0060871
0.00718733
0.00840456
0.00974486
0.0112134
0.0128165
0.0145607
0.0164549
0.0185069
0.0207295
0.0231317
0.0257268
0.0285302
0.0315608
0.0348379
0.0383857
0.0422357
0.0464206
0.0509759
0.0559429
0.0613757
0.0673265
0.0738507
0.0810192
0.0889103
0.0976256
0.10729
0.118057
0.130119
0.143702
0.159072
0.176531
0.196482
0.219377
0.245809
0.276509
0.312387
0.354582
0.404498
0.463835
0.534619
0.619298
0.720364
0.840895
0.983759
1.15169
1.35591
1.58614
1.84253
2.12666
2.44008
2.77019
3.12693
3.50774
3.90749
4.31996
4.74601
5.18152
5.61723
6.05225
6.48348
6.90411
7.31024
7.70671
8.08653
8.44663
8.78567
9.10377
9.39681
9.66527
9.90916
10.1285
10.3221
10.4914
10.6372
10.7603
10.8618
10.943
11.0053
11.0506
11.0814
11.1004
11.1107
11.115
11.1171
"""
RF356_7 = """6.85E-06
1.80E-05
3.71E-05
6.61E-05
0.000127583
0.000221823
0.000355811
0.00053609
0.000768745
0.00105937
0.0014132
0.00183505
0.00232931
0.00290017
0.00355161
0.00428733
0.00511086
0.00602554
0.00703457
0.00814173
0.00935004
0.0106634
0.0120858
0.0136218
0.015276
0.0170532
0.01896
0.0210041
0.0231937
0.0255399
0.0280535
0.0307515
0.0336484
0.0367663
0.0401231
0.0437495
0.0476701
0.0519226
0.0565436
0.0615803
0.0670758
0.0730941
0.0796989
0.0869524
0.094947
0.103803
0.113635
0.124603
0.136898
0.150728
0.166336
0.184055
0.204238
0.227347
0.253925
0.284616
0.320245
0.361796
0.410441
0.467624
0.535037
0.614647
0.708412
0.818533
0.947069
1.09629
1.26695
1.46004
1.67611
1.91374
2.17074
2.44558
2.73543
3.03676
3.34712
3.66305
3.98129
4.29842
4.61177
4.91794
5.21496
5.4997
5.77027
6.02462
6.26165
6.48003
6.67981
6.86047
7.0215
7.16281
7.2845
7.38702
7.47127
7.53863
7.5907
7.62931
7.65628
7.67371
7.68384
7.68831
7.69069
"""
RF356_8 = """7.31E-06
1.92E-05
3.96E-05
7.05E-05
0.000136097
0.000236696
0.000379832
0.000572564
0.000821518
0.00113287
0.00151252
0.00196595
0.00249837
0.00311468
0.00381968
0.00461789
0.00551363
0.00651154
0.0076158
0.00883116
0.0101627
0.0116156
0.0131951
0.0149084
0.0167615
0.0187628
0.0209211
0.0232466
0.0257506
0.0284467
0.0313505
0.0344788
0.0378507
0.0414931
0.0454334
0.0497106
0.0543618
0.0594329
0.0649803
0.0710654
0.0777573
0.0851495
0.0933444
0.102457
0.112643
0.124079
0.136986
0.15162
0.168311
0.187443
0.20948
0.235045
0.264832
0.299717
0.340784
0.389806
0.447657
0.516366
0.598166
0.695534
0.810729
0.946968
1.10677
1.29214
1.50469
1.74502
2.01304
2.30756
2.62673
2.96786
3.32796
3.70356
4.09106
4.48674
4.88776
5.29724
5.7012
6.09768
6.50413
6.92391
7.3105
7.69438
8.08454
8.44381
8.77495
9.1109
9.41289
9.66899
9.8936
10.0754
10.2185
10.34
10.4393
10.5191
10.581
10.6262
10.656
10.6735
10.6811
10.684
10.6837
"""
RF356_9 = """7.26E-06
1.91E-05
3.93E-05
7.00E-05
0.000135138
0.000234959
0.00037693
0.000567923
0.000814453
0.00112245
0.00149758
0.00194483
0.00246912
0.00307466
0.00376547
0.00454557
0.00541838
0.0063865
0.00745377
0.00862356
0.00989918
0.0112835
0.0127817
0.0143969
0.0161323
0.0179918
0.0199797
0.0221019
0.0243657
0.0267792
0.0293523
0.0320984
0.0350309
0.0381664
0.0415287
0.04514
0.0490194
0.053202
0.0577176
0.0626004
0.0678976
0.0736689
0.0799653
0.0868513
0.0944073
0.10272
0.111889
0.122038
0.133318
0.145897
0.159987
0.175832
0.19375
0.214083
0.237273
0.263844
0.294482
0.329954
0.371313
0.419586
0.476126
0.542335
0.622349
0.713758
0.819403
0.941548
1.08268
1.24064
1.41883
1.61622
1.83137
2.06186
2.30718
2.56615
2.83444
3.10916
3.38745
3.66772
3.94414
4.21609
4.48074
4.7356
4.97682
5.20529
5.41898
5.61681
5.79822
5.96201
6.1081
6.23675
6.34752
6.44065
6.51731
6.57854
6.6253
6.65986
6.68378
6.69895
6.70745
6.71107
6.71274
"""
RF356_10 = """"""
RF356 = [np.array([float(x) for x in rf.split()]) for rf in [RF356_1, RF356_2, RF356_3, RF356_4, RF356_5, RF356_6,
                                                             RF356_7, RF356_8, RF356_9]]


S312 = [rf * (1000 * 1000) / (DomainPhysicalDimension ** 2) for rf in RF312]
S320 = [rf * (1000 * 1000) / (DomainPhysicalDimension ** 2) for rf in RF320]
S336 = [rf * (1000 * 1000) / (DomainPhysicalDimension ** 2) for rf in RF336]
S356 = [rf * (1000 * 1000) / (DomainPhysicalDimension ** 2) for rf in RF356]

## Multiple valencies Plot
mean_S312 = np.mean(S312, axis=0)
std_S312 = np.std(S312, axis=0)
mean_S320 = np.mean(S320, axis=0)
std_S320 = np.std(S320, axis=0)
mean_S336 = np.mean(S336, axis=0)
std_S336 = np.std(S336, axis=0)
mean_S356 = np.mean(S356, axis=0)
std_S356 = np.std(S356, axis=0)

# Calculate derivatives
DIFF_312 = [np.gradient(stress, strain_adjusted) for stress in S312]
DIFF_320 = [np.gradient(stress, strain_adjusted) for stress in S320]
DIFF_336 = [np.gradient(stress, strain_adjusted) for stress in S336]
DIFF_356 = [np.gradient(stress, strain_adjusted) for stress in S356]

# Mean and standard deviation
mean_DIFF_312 = np.mean(DIFF_312, axis=0)
std_DIFF_312 = np.std(DIFF_312, axis=0)
mean_DIFF_320 = np.mean(DIFF_320, axis=0)
std_DIFF_320 = np.std(DIFF_320, axis=0)
mean_DIFF_336 = np.mean(DIFF_336, axis=0)
std_DIFF_336 = np.std(DIFF_336, axis=0)
mean_DIFF_356 = np.mean(DIFF_356, axis=0)
std_DIFF_356 = np.std(DIFF_356, axis=0)


stretch = 1 + strain_adjusted


plt.figure(figsize=(6, 6))
plt.loglog(strain_adjusted, mean_DIFF_312, label="z = 3.12", color=viridis(0.3), linewidth=2)
plt.fill_between(
    strain_adjusted,
    mean_DIFF_312 - std_DIFF_312,
    mean_DIFF_312 + std_DIFF_312,
    color=viridis(0.3),
    alpha=0.4,
)

plt.loglog(strain_adjusted, mean_DIFF_320, label="z = 3.20", color=viridis(0.5), linewidth=2)
plt.fill_between(
    strain_adjusted,
    mean_DIFF_320 - std_DIFF_320,
    mean_DIFF_320 + std_DIFF_320,
    color=viridis(0.5),
    alpha=0.4,
)

plt.loglog(strain_adjusted, mean_DIFF_336, label="z = 3.36", color=viridis(0.7), linewidth=2)
plt.fill_between(
    strain_adjusted,
    mean_DIFF_336 - std_DIFF_336,
    mean_DIFF_336 + std_DIFF_336,
    color=viridis(0.7),
    alpha=0.4,
)

plt.loglog(strain_adjusted, mean_DIFF_356, label="z = 3.56", color=viridis(0.9), linewidth=2)
plt.fill_between(
    strain_adjusted,
    mean_DIFF_356 - std_DIFF_356,
    mean_DIFF_356 + std_DIFF_356,
    color=viridis(0.9),
    alpha=0.4,
)
plt.title("connectivity effect", fontsize=16, fontweight='bold', fontname='Source Sans Pro')
plt.xlabel("$\lambda - 1$ [-]", fontsize=14, labelpad=0.2)
plt.ylabel("differential modulus [Pa]", fontsize=14, labelpad=0.2)
plt.legend(
    fontsize=12,
    loc="upper left",
    frameon=True,
    borderpad=1.2,
    labelspacing=1.15
)
plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.xlim(0.01, 0.49)
plt.ylim(50, 50000)
plt.grid(True, which="both", ls="--", lw=0.5)
output_path = os.path.join(output_directory, "connectivity_effect_plot.svg")
plt.savefig(output_path, format="svg")
plt.show()




plt.figure(figsize=(6, 6))
plt.semilogy(stretch, mean_DIFF_312, label="z = 3.12", color=viridis(0.3), linewidth=2)
plt.fill_between(
    stretch,
    mean_DIFF_312 - std_DIFF_312,
    mean_DIFF_312 + std_DIFF_312,
    color=viridis(0.3),
    alpha=0.4,
)

plt.semilogy(stretch, mean_DIFF_320, label="z = 3.20", color=viridis(0.5), linewidth=2)
plt.fill_between(
    stretch,
    mean_DIFF_320 - std_DIFF_320,
    mean_DIFF_320 + std_DIFF_320,
    color=viridis(0.5),
    alpha=0.4,
)

plt.semilogy(stretch, mean_DIFF_336, label="z = 3.36", color=viridis(0.7), linewidth=2)
plt.fill_between(
    stretch,
    mean_DIFF_336 - std_DIFF_336,
    mean_DIFF_336 + std_DIFF_336,
    color=viridis(0.7),
    alpha=0.4,
)

plt.semilogy(stretch, mean_DIFF_356, label="z = 3.56", color=viridis(0.9), linewidth=2)
plt.fill_between(
    stretch,
    mean_DIFF_356 - std_DIFF_356,
    mean_DIFF_356 + std_DIFF_356,
    color=viridis(0.9),
    alpha=0.4,
)
plt.title("connectivity effect", fontsize=16, fontweight='bold', fontname='Source Sans Pro')
plt.xlabel("$\lambda$ [-]", fontsize=14, labelpad=0.2)
plt.ylabel("differential modulus [Pa]", fontsize=14, labelpad=0.2)
plt.legend(
    fontsize=12,
    loc="upper left",
    frameon=True,
    borderpad=1.2,
    labelspacing=1.15
)
plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.xlim(1.01, 1.49)
#plt.ylim(50, 50000)
plt.grid(True, which="both", ls="--", lw=0.5)
output_path = os.path.join(output_directory, "connectivity_effect_plot_stretch.svg")
plt.savefig(output_path, format="svg")
plt.show()



plt.figure(figsize=(6, 6))
plt.loglog(
    x_12,
    y_12,
    marker="s",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.3),
    linestyle="None",
    label="z = 3.12",
)

# Dataset 20 (Corrected Monotonic)
plt.loglog(
    x_20,
    y_20,
    marker="^",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.5),
    linestyle="None",
    label="z = 3.20",
)


# Dataset 36
plt.loglog(
    x_36,
    y_36,
    marker="o",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.7),
    linestyle="None",
    label="z = 3.36",
)

# Dataset 56
plt.loglog(
    x_56,
    y_56,
    marker="*",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.9),
    linestyle="None",
    label="z = 3.56",
)

# Apply bold font explicitly to the title
plt.title("experimental data [Jansen et al. (2018)]", fontsize=16, fontweight='bold', fontname='Source Sans Pro')
plt.xlabel("$\lambda - 1$ [-]", fontsize=14, labelpad=0.2)
plt.ylabel("differential modulus [Pa]", fontsize=14, labelpad=0.2)
plt.legend(
    fontsize=12,
    loc="upper left",
    frameon=True,
    borderpad=1.2,
    labelspacing=1.15
)
plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.xlim(0.01, 0.49)
plt.ylim(50, 50000)
plt.grid(True, which="both", ls="--", lw=0.5)
output_path = os.path.join(output_directory, "experimentaldata_plot.svg")
plt.savefig(output_path, format="svg")
plt.show()


stretch_exp_12 = x_12 + 1
stretch_exp_20 = x_20 + 1
stretch_exp_36 = x_36 + 1
stretch_exp_56 = x_56 + 1

plt.figure(figsize=(6, 6))
plt.semilogy(
    stretch_exp_12,
    y_12,
    marker="s",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.3),
    linestyle="None",
    label="z = 3.12",
)

# Dataset 20 (Corrected Monotonic)
plt.semilogy(
    stretch_exp_20,
    y_20,
    marker="^",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.5),
    linestyle="None",
    label="z = 3.20",
)


# Dataset 36
plt.semilogy(
    stretch_exp_36,
    y_36,
    marker="o",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.7),
    linestyle="None",
    label="z = 3.36",
)

# Dataset 56
plt.semilogy(
    stretch_exp_56,
    y_56,
    marker="*",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.9),
    linestyle="None",
    label="z = 3.56",
)

# Apply bold font explicitly to the title
plt.title("experimental data [Jansen et al. (2018)]", fontsize=16, fontweight='bold', fontname='Source Sans Pro')
plt.xlabel("$\lambda$ [-]", fontsize=14, labelpad=0.2)
plt.ylabel("differential modulus [Pa]", fontsize=14, labelpad=0.2)
plt.legend(
    fontsize=12,
    loc="upper left",
    frameon=True,
    borderpad=1.2,
    labelspacing=1.15
)
plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.xlim(1.01, 1.49)
plt.ylim(50, 50000)
plt.grid(True, which="both", ls="--", lw=0.5)
output_path = os.path.join(output_directory, "experimentaldata_plot_stretch.svg")
plt.savefig(output_path, format="svg")
plt.show()


plt.figure(figsize=(6, 6))
plt.loglog(strain_adjusted, mean_DIFF_312, label="z = 3.12, in silico", color=viridis(0.3), linewidth=2)
plt.fill_between(
    strain_adjusted,
    mean_DIFF_312 - std_DIFF_312,
    mean_DIFF_312 + std_DIFF_312,
    color=viridis(0.3),
    alpha=0.4,
)

plt.loglog(strain_adjusted, mean_DIFF_320, label="z = 3.20, in silico", color=viridis(0.5), linewidth=2)
plt.fill_between(
    strain_adjusted,
    mean_DIFF_320 - std_DIFF_320,
    mean_DIFF_320 + std_DIFF_320,
    color=viridis(0.5),
    alpha=0.4,
)

plt.loglog(strain_adjusted, mean_DIFF_336, label="z = 3.36, in silico", color=viridis(0.7), linewidth=2)
plt.fill_between(
    strain_adjusted,
    mean_DIFF_336 - std_DIFF_336,
    mean_DIFF_336 + std_DIFF_336,
    color=viridis(0.7),
    alpha=0.4,
)

plt.loglog(strain_adjusted, mean_DIFF_356, label="z = 3.56, in silico", color=viridis(0.9), linewidth=2)
plt.fill_between(
    strain_adjusted,
    mean_DIFF_356 - std_DIFF_356,
    mean_DIFF_356 + std_DIFF_356,
    color=viridis(0.9),
    alpha=0.4,
)
plt.loglog(
    x_12,
    y_12,
    marker="s",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.3),
    linestyle="None",
    label="z = 3.12, in vitro",
)

# Dataset 20 (Corrected Monotonic)
plt.loglog(
    x_20,
    y_20,
    marker="^",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.5),
    linestyle="None",
    label="z = 3.20, in vitro",
)


# Dataset 36
plt.loglog(
    x_36,
    y_36,
    marker="o",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.7),
    linestyle="None",
    label="z = 3.36, in vitro",
)

# Dataset 56
plt.loglog(
    x_56,
    y_56,
    marker="*",
    markersize=10,
    markeredgewidth=2,
    markeredgecolor="black",
    markerfacecolor=viridis(0.9),
    linestyle="None",
    label="z = 3.56, in vitro",
)

plt.xlabel("$\lambda - 1$ [-]", fontsize=14, labelpad=0.2)
plt.ylabel("differential modulus [Pa]", fontsize=14, labelpad=0.2)

from matplotlib.lines import Line2D

# In silico (lines)
legend_in_silico = [
    Line2D([0], [0], color=viridis(0.3), lw=2, label="z = 3.12"),
    Line2D([0], [0], color=viridis(0.5), lw=2, label="z = 3.20"),
    Line2D([0], [0], color=viridis(0.7), lw=2, label="z = 3.36"),
    Line2D([0], [0], color=viridis(0.9), lw=2, label="z = 3.56"),
]

# In vitro (markers)
legend_in_vitro = [
    Line2D([0], [0], color='black', marker='s', markersize=8, linestyle='None',
           markerfacecolor=viridis(0.3), label="z = 3.12"),
    Line2D([0], [0], color='black', marker='^', markersize=8, linestyle='None',
           markerfacecolor=viridis(0.5), label="z = 3.20"),
    Line2D([0], [0], color='black', marker='o', markersize=8, linestyle='None',
           markerfacecolor=viridis(0.7), label="z = 3.36"),
    Line2D([0], [0], color='black', marker='*', markersize=10, linestyle='None',
           markerfacecolor=viridis(0.9), label="z = 3.56"),
]

first_legend = plt.legend(handles=legend_in_silico, title="in silico", fontsize=12, title_fontsize=12, loc="upper left")
second_legend = plt.legend(handles=legend_in_vitro, title="in vitro [Jansen et al. (2018)]", fontsize=12, title_fontsize=12, loc="upper center")

# Add both legends to the axes
plt.gca().add_artist(first_legend)

plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.xlim(0.01, 0.49)
plt.ylim(50, 50000)
plt.grid(True, which="both", ls="--", lw=0.5)
output_path = os.path.join(output_directory, "validation_plot.svg")
plt.savefig(output_path, format="svg")
plt.show()

## TEST SOME NEW DATA

# Define the smooth step function
def smooth_step(t):
    return t**3 * (10 - 15*t + 6*t**2)

t_new = np.linspace(0.0, 1, 101)
strain = np.array([smooth_step(time) for time in t_new])
strain_adjusted = strain * 0.5


NEW = """-0
1.59574E-06
1.25662E-05
4.17883E-05
9.75196E-05
0.00018746
0.000318832
0.000498122
0.00073185
0.00102552
0.0013843
0.00181289
0.00231552
0.00289598
0.00355759
0.00430327
0.00513549
0.00605634
0.0070675
0.00817026
0.00936557
0.010654
0.0120357
0.0135106
0.0150783
0.0167379
0.0184885
0.0203286
0.0222567
0.0242708
0.0263687
0.0285481
0.0308064
0.0331406
0.0355477
0.0380245
0.0405675
0.043173
0.0458374
0.0485565
0.0513264
0.0541429
0.0570016
0.0598981
0.0628279
0.0657863
0.0687688
0.0717705
0.0747868
0.0778126
0.0808434
0.083874
0.0869
0.0899162
0.0929179
0.0959003
0.0988588
0.101788
0.104685
0.107544
0.11036
0.11313
0.115849
0.118513
0.121119
0.123662
0.126138
0.128545
0.130879
0.133138
0.135317
0.137415
0.139429
0.141357
0.143197
0.144947
0.146607
0.148175
0.149649
0.151031
0.152319
0.153514
0.154617
0.155628
0.156549
0.157381
0.158127
0.158788
0.159369
0.159871
0.1603
0.160658
0.160952
0.161186
0.161365
0.161496
0.161586
0.161642
0.161671
0.161682
0.161683
"""

NEW = [np.array([float(x) for x in rf.split()]) for rf in [NEW]]

NEW_STRESS = [rf * (1000 * 1000) / (24 ** 2) for rf in NEW]
NEW_DIFF = [np.gradient(stress, strain_adjusted) for stress in NEW_STRESS]


plt.figure(figsize=(6, 6))
plt.plot(strain_adjusted, NEW_STRESS[0], label="NLGEOM = OFF", color="black", linewidth=2)

plt.title("ZX Shear - new topologies", fontsize=16, fontweight='bold', fontname='Source Sans Pro')
plt.xlabel("$\lambda - 1$ [-]", fontsize=14, labelpad=0.2)
plt.ylabel("stress [Pa]", fontsize=14, labelpad=0.2)
plt.legend(
    fontsize=12,
    loc="upper left",
    frameon=True,
    borderpad=1.2,
    labelspacing=1.15
)
plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.grid(True, which="both", ls="--", lw=0.5)
#output_path = os.path.join(output_directory, "connectivity_effect_plot.svg")
#plt.savefig(output_path, format="svg")
plt.show()




"""
import matplotlib.pyplot as plt
import numpy as np
import os
from matplotlib.cm import viridis
from matplotlib.lines import Line2D

plt.figure(figsize=(6, 6))

# Define z values and corresponding colors
z_values = [3.12, 3.20, 3.36, 3.56]
colors = [viridis(0.3), viridis(0.5), viridis(0.7), viridis(0.9)]
markers = ["s", "^", "o", "*"]

# Plot in silico data
for i, z in enumerate(z_values):
    mean_diff = globals()[f"mean_DIFF_{int(z * 100)}"]
    std_diff = globals()[f"std_DIFF_{int(z * 100)}"]
    plt.loglog(strain_adjusted, mean_diff, color=colors[i], linewidth=2)
    plt.fill_between(
        strain_adjusted, mean_diff - std_diff, mean_diff + std_diff, color=colors[i], alpha=0.4
    )

# Plot in vitro data
for i, z in enumerate(z_values):
    x_data = globals()[f"x_{int(z * 100) // 10}"]
    y_data = globals()[f"y_{int(z * 100) // 10}"]
    plt.loglog(
        x_data,
        y_data,
        marker=markers[i],
        markersize=10,
        markeredgewidth=2,
        markeredgecolor="black",
        markerfacecolor=colors[i],
        linestyle="None"
    )

plt.xlabel("strain [-]", fontsize=14, labelpad=0.2)
plt.ylabel("differential modulus [Pa]", fontsize=14, labelpad=0.2)

# Create a legend with unique entries
legend_elements = [
    Line2D([0], [0], color=colors[i], linewidth=2, label=f"z = {z_values[i]}")
    for i in range(len(z_values))
] + [
    Line2D([0], [0], marker="o", color='w', markerfacecolor="gray",
           markeredgecolor='black', markersize=10, linestyle="None", label="in vitro")
]  # Single entry for in vitro data

plt.legend(handles=legend_elements, fontsize=12, loc="upper left", frameon=True, borderpad=1.2, labelspacing=1.15)

plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.xlim(0.01, 0.49)
plt.ylim(50, 50000)
plt.grid(True, which="both", ls="--", lw=0.5)

output_path = os.path.join(output_directory, "experimentaldata_plot.svg")
plt.savefig(output_path, format="svg")
plt.show()

"""
